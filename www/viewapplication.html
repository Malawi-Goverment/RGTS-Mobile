<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RGTS Entry App Template</title>
    <link rel="stylesheet" href="./lib/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="./lib/semantic/dist/semantic.min.css">
    <link rel="stylesheet" href="./lib/sweetalerts/sweetalert.css">
    <link rel="stylesheet" href="./css/fonts.css">
    <link rel="stylesheet" href="./css/app.css">


</head>

<body>
    <div id="wrapper">
        <div class="ui right demo vertical inverted sidebar labeled icon menu">
            <a class="item">
                <i class="cog icon"></i>
                Settings
            </a>

            <a class="item">
                <i class="info icon"></i>
                About
            </a>
            <a class="item" onclick="logout()">
                <i class="lock icon"></i>
                Logout
            </a>

        </div>
        <div class="pusher">
            <header class="ui top attched segment raised p-3 flat m-0">
                <div class="row">
                    <div class="col-2 sidebutton-container  text-center">
                        <a href="home.html" class="text-primary header-button">
                            <i class="icon chevron left"></i>
                        </a>
                    </div>
                    <div class="col-8 mx-auto text-center">
                        <h5 class="text-primary">View ( <span class="display_ref_id"></span> )</h5>
                    </div>
                    <div class="col-2 sidebutton-container text-center">
                        <a href="#sideBarButton" onclick="pushAside()" class="text-primary header-button">
                            <i class="icon bars"></i>
                        </a>
                    </div>
                </div>
            </header>
            <main class="p-2 mt-0 container-fluid border border-light">
                <div class="row">
                    <div class="col-10 mx-auto card ui segment" id="previewSegment">
                        <table class="table card-body">

                        </table>
                    </div>
                    <div class="col-10 mx-auto">
                        <button data-target="#captureModal" data-toggle="modal" data-backdrop="static"
                            class="ui button icon medium fluid positive circular">
                            Upload Image
                        </button>
                    </div>
                    <div class="col-12">
                        <hr>

                    </div>


                </div>
            </main>
            <footer class="ui bottom attached segment raised p-3">
                <div class="row">
                    <div class="col-9">
                        <p class="text-primary">&copy;2021 - RGTS Entry App</p>
                    </div>
                    <div class="col-3 text-right">
                        <p class="text-primary">V 1.0</p>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <style>
        .col-4.image_section {
            width: 100%;
            height: 13vh;
            margin: .4em;
            background-position: top center;
            background-repeat: no-repeat;
            background-size: cover;
            background-clip: content-box;
        }
    </style>
    <script src="./js/jquery-1.11.3.min.jsx"></script>
    <script src="./lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="./lib/semantic/dist/semantic.min.js"></script>
    <script src="./lib/sweetalerts/sweetalert.min.js"></script>
    <script src="./js/app.jsx"></script>
    <script src="./js/files.jsx"></script>
    <script>
        $(document).ready(() => {
            setUserData();
            viewApplication();
        })
    </script>
    <script>
        let ReferenceID = localStorage.getItem('NavigationViewReference')
        $('.display_ref_id').html(ReferenceID)

        function viewApplication() {
            $("#previewSegment").addClass('loading')
            fetch(`${baseURL}/applications?ReferenceID=${ReferenceID}`)
                .then(res => res.json())
                .then(res => {
                    $("#previewSegment").removeClass('loading')
                    console.log(res)
                    if (res.status == 'success') {
                        application_of_focus = res.data[0].application_id
                        renderApplication(res.data[0])
                    }
                })
                .catch(err => {
                    $("#previewSegment").removeClass('loading')
                    toast('Failed to fetched Application data!', 'error')
                })
        }

        function renderApplication(data) {
            console.log(data)

            let DOM = ` <tr>
                           <th>Applicant First Name:</th>
                           <th>${data.ApplicantFullName}</th>
                       </tr>
                       <tr>
                            <th>Gender:</th>
                            <th>${data.Gender}</th>
                        </tr>
                       <tr>
                           <th>Phone Number:</th>
                           <th>${data.ContactPhone}</th>
                       </tr>
                       <tr>
                            <th>Email Address:</th>
                            <th>${data.ContactEmail}</th>
                        </tr>
                        <tr>
                            <th>Service:</th>
                            <th>${data.ServiceName}</th>
                        </tr>
                        <tr>
                            <th>AssignmentStatus</th>
                            <th>${data.AssignmentStatus}</th>
                        </tr>
                        <tr>
                            <th>ProgressStage</th>
                            <th>${data.ProgressStage}</th>
                        </tr>
                        <tr>
                            <th>Total Files</th>
                            <th>${data.document_count}</th>
                        </tr>
                        <tr>
                            <th>Created At</th>
                            <th>${data.Stamp}</th>
                        </tr>`


            $("#previewSegment table").html(DOM)
        }
    </script>
    <!-- Modal -->
    <div style="z-index: 1500 !important;" class="modal fade" id="captureModal" tabindex="-1" role="dialog"
        aria-labelledby="captureModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="z-index: 20;" role="document">
            <div class="modal-content ui segment" style="z-index: 20;" id="capture_modal">
                <div class="modal-header bg-primary">
                    <h5 class="modal-title text-white" id="captureModalLabel">CAPTURED IMAGE</h5>
                    <button type="button" id="closeModalBtn" class="close text-white" data-dismiss="modal"
                        aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-row">
                        <div class="col-12 form-group px-4">
                            <label for="">Select Document Type:</label>
                            <select id="document_to_view" class="form-control form-control-lg">
                                <option value="">SELECT</option>
                                <option value="APPLICATION_FORM">APPLICATION FORM</option>
                                <option value="PAYMENT_RECEIPT">PAYMENT RECEIPT</option>
                                <option value="GENERAL_RECEIPT">GENERAL RECEIPT</option>
                                <option value="NATIONAL_ID">NATIONAL ID</option>
                                <option value="OTHER">OTHER</option>
                            </select>
                        </div>
                        <div class="col-12 form-group px-4">
                            <label for="">SubTitle</label>
                            <input type="text" id="document_subtitle" placeholder="e.g Page 1/BackPage"
                                class="form-control form-control-lg">
                        </div>
                        <div class="col-12 form-group px-4">
                            <input type="file" hidden id="imageActual" accept="Image/*">
                            <button type="button" id="captureImageBtn" class="btn btn-lg btn-block btn-danger">
                                Pick File <i class="icon camera"></i>
                            </button>
                        </div>
                        <div class="col-12">
                            <hr>
                            <div class="row" id="image_canvas">
                                <!-- <div class="col-4 image_section img img-thumbnail"></div> -->
                            </div>
                        </div>
                        <div class="col-12">
                            <button onclick="saveImages()" class="btn btn-md btn-success float-right">Save <i
                                    class="icon check circle"></i></button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</body>

</html>